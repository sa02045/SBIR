# 1.1 현대대수 학습

- 이번 장은 타원곡선 암호를 파악하기 위해 필요하다
- 타원곡선 암호는 비트코인의 핵심인 `전자서명` `서명검증 알고리즘`을 이해하는데 필수
- 슈노어 서명, 기밀 트랜잭션등을 이해할 수 있음

# 1.2 유한체 정의

수학에서 유한체는 2개의 연산자(+,\*)를 가진 집합, 그 집합의 원소 수가 유한하다는 특징

1. 집합은 덧셈과 곱셈에 대해 닫혀있다. (원소끼리 덧셈,곱셈한 값은 집합내에 존재한다)
2. 덧셈과 곱셈에 대한 항등원이 집합 내에 있다 (0과 1)
3. 덧셈에 대한 역원이 집합 내에 있다
   - a가 집합 내에 있으면 -a가 집합 내에 있다
   - 역원을 사용해서 뺄셈을 정의할 수 있다
4. 곱셈에 대해서도 역원이 집합 내에 있다
   - 곱셈에 대한 역원을 사용하면 나눗셈을 정의할 수 있다

- `위수` : 집합크기를 표현하는 값 p
- 우리에게 친숙한 덧셈, 곱셈방식과는 다른 덧셈과 곱셈을 정의할 수 있음

# 1.3 유한집합 정의하기

집합의 위수가 p이면 집합의 원소는 0,1,2,3,4,5 ... p-1로 쓸 수 있다.

- 자연수라고 생각할 필요는 없음
- 유한체의 위수는 항상 `가장 큰 숫자 원소보다 하나가 더 많은 값`임을 알 수 있다
- 위수는 반드시 소수이거나, 소수의 거듭제곱을 위수로 가져야함
- 우리가 관심있는 것은 소수를 위수로 갖는 유한체

## 유한체 원소 1개를 표현하는 클래스

```py
class FieldElement:
    def __init__(self, num, prime):
        if num >= prime or num < 0:
            error = `Num {} not in field range 0 to {}`.format(num,prime-1)
            return ValueError(error)
        self.num = num
        self.prime = prime
    def __repr__(self):
        return `FieldElement_{}({})`.format(self.prime,self.num)

    def __eq__(self,other):
        if other is None:
            return False
        return self.num == other.num and self.prime == other.prime
```

# 1.4 나머지연산

- 아무리 큰 숫자라도 나머지 연산 후 작은 범위의 숫자로 변환되기 때문에 숫자 개수가 한정되어 있는 유한체에서 매우 적절한 속성
- 유한체 연산을 정의할 때 나머지 연산을 사용하겠다

## 파이썬 나머지 연산

`%` 연산자를 사용

# 1.5 유한체 덧셈과 뺄셈

- 유한체에서 덧셈을 정의할 때 그 결과가 항상 유한체에 속해있어야함 (닫혀있어야함)
- 나머지 연산을 사용하여 덧셈을 새롭게 정의, 닫혀있는 연산으로 만들 수 있음
  - a+b를 (a+b)%19로 정의한다면 위수를 19로가지는 유한체집합에서 덧셈은 닫혀있음

## 유한체에서 뺄셈을 정의하는 메서드

```py
def __sub__(self, other):
    if self.prime != other.prime:
        raise TypeError('Cannot subtract two numbers in different Fields')
    num = (self.num - other.num) % self.prime
    return self.__class__(num, self.prime)
```

# 1.6 유한체 곱셈과 거듭제곱

- 유한체 안에서 정의된 연산결과는 항상 그 유한체 안에 속해야한다

# 1.7 유한체 나눗셈

일반대수와 마찬가지로 유한체에서 나눗셈도 등식이 성립한다

- 유한체에서도 나눗셈에 대해 닫혀있다
- 3\*7=2 를 모르는 상황에서 어떻게 2/7를 계산하는가
- 소수인 p와 0보다 큰 n에 대해 n \* (p-1)은 항상 1임을 알 수 있음
- 페르마의 소정리에 의해

  - n \* (p-1) %p= 1

- 따라서 어떤 원소 b의 역원 b \* -1은 거듭제곱을 통해 계산할 수 있습니다

- 2/7 = 2\*7\*\*(19-2)

- 지수가 커질 수 있기 때문에 계산 시간이 많이 걸릴 수 있다.
- 파이썬에서 pow()를 사용하여 세번째 매개변수를 넣어서 효율적으로 계산할 수 있다

# 1.8 거듭제곱 메서드 수정
